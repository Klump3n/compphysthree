\documentclass[10pt,a4paper]{article}
%]{report}

\usepackage[a4paper, top=2cm, bottom=2.5cm, left=3cm, right=3cm]{geometry}
%\usepackage[
%    vmarginratio=2:2.5, %Verhï¿½ltnis der oben/unten Seitenrï¿½nder zur automatischen Berechnung
%    paper=a4paper,
%    lmargin=3cm, % mittlerer Rand
%    rmargin=3cm, % ï¿½uï¿½erer Rand
%    marginparwidth=2.3cm, % Breite des Marginpars
%    includehead, % Kopfzeile in Berechnung einbeziehen
%    includemp % Marginpar in die Berechnung mit einbeziehen
%]{geometry}
%\setlength\marginparwidth{2.3cm} %Die wird spï¿½ter zum Rechnen gebraucht, wird aber durch die Angabe im geometry package nicht automatisch richtig gesetzt.


%============================================================
% Pakete
%============================================================

\usepackage[english, ngerman]{babel}    % mehrsprachiger Textsatz
% babel: letzte Sprache in Optionen zeigt die Sprache des Dokumentes
% und kann durch den Befehl \selectlanguage{} geaendert werden
% Passen Sie die Optionen des babel-Paketes nach Bedarf an!
\usepackage[utf8]{inputenc}       % Eingabekodierung Parameter latin1 darf geï¿½ndert werden
\usepackage[T1]{fontenc}                % Schriftenkodierung
\usepackage{graphicx}                       % zum Einbinden von Grafiken
\usepackage{lmodern}                        % Ersatz fuer Computer Modern-Schriften
                                                                % zum besseren Aussehen am Bildschirm
\usepackage{epstopdf}		% Grafiken einbinden
\usepackage{caption}		%Grafiken beschriften
%\usepackage{verbatimfiles}	% Ganze Dateien als Verbatim einbinden
% \usepackage{programs}	% Ganze Dateien als Verbatim einbinden
\usepackage{verbatim}		% Mehrzeilige Kommentare
\usepackage{multicol}		% Mehrere Spalten
\usepackage{hyphsubst}		% Silbentrennung
\usepackage{xcolor,soul}
\usepackage{float}				%Sachen an der richtigen Stelle ausgeben
\restylefloat{figure}				%Abbildungen an der richtigen Stelle ausgeben
\restylefloat{table}				%Tabellen an der richtigen Stelle ausgeben
\usepackage{array}				%fï¿½r Tabellen
\newcolumntype{C}{>{$}c<{$}} 	%Tabellenspalten C mit mathematischem Inhalt
% \usepackage{subfigure}
\usepackage{ulem}				%doppelt unterstreichen
\usepackage{siunitx}
\usepackage{hyperref}
\usepackage{booktabs}
\usepackage{subcaption}

\usepackage{etex} %needs to be used to avoid 'no room error in pgfplots'
\usepackage{pgfplots}
\usepackage{tikz}
\usepackage{tikz-3dplot}
%\usepackage{tikzscale}
\usepgfplotslibrary{polar}
\usetikzlibrary[pgfplots.colormaps]
\pgfplotsset{compat=newest}
\pgfplotsset{plot coordinates/math parser=false}
\newlength\figureheight
\newlength\figurewidth
%\pgfplotsset{y tick label style={/pgf/number format/fixed}}
%\pgfplotsset{yticklabel style={text width=2.2em,align=right}}%,fixed zerofill, precision=1}}
%\pgfplotsset{every x tick/.append style={line width=1pt}}
%\pgfplotsset{every y tick/.append style={line width=1pt}}
%\pgfplotsset{every axis plot/.append style={line width=1.0pt}}
%\pgfplotscreateplotcyclelist{mycolorlist}{blue,red,green,brown,teal,orange,violet,cyan,green!70!black,magenta,gray}

\usepackage{tikzscale}
\usetikzlibrary{external}
\usetikzlibrary{fadings}
\usetikzlibrary{arrows}
\usetikzlibrary{calc}
\usetikzlibrary{plotmarks}
\usepgfplotslibrary{external}
\tikzset{external/force remake=false}
\tikzset{external/system call={pdflatex \tikzexternalcheckshellescape -halt-on-error -interaction=batchmode -jobname "\image" "\texsource"}}

\tikzexternalize

% define colors for source code list
\definecolor{colKeys}{rgb}{0,0,1}
\definecolor{colIdentifier}{rgb}{0,0,0}
\definecolor{colComments}{rgb}{0,1,0.3}
%\definecolor{colString}{rgb}{0,0.5,0}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{colString}{rgb}{0.63,0.13,0.94}

% Code-Listings print source code
\usepackage{listings}
\lstset{language=Python,		% choose the language of the code
	inputencoding=latin1,
	keywords={break,case,catch,continue,else,elseif,end,for,function,
	 global,if,otherwise,persistent,return,switch,try,while,ones,zeros},
   	float=hbp,
%  	 basicstyle=\ttfamily\small,				% the size of the fonts that are used for the code
   	identifierstyle=\color{colIdentifier},
   	keywordstyle=\color{blue},
   	commentstyle=\color{dkgreen},
  	stringstyle=\color{colString},
   	columns=flexible,
  	tabsize=2,								% sets default tabsize to 2 spaces
   	%frame=none; %single,
  	 numbers=left,						% where to put the line-numbers
  	 showspaces=false,                               % show spaces adding particular underscores
  	 numberstyle=\ttfamily\small\color{gray},
% numberstyle=\footnotesize,                      % the size of the fonts that are used for the line-numbers
  	 stepnumber=1,                                           % the step between two line-numbers. If it's 1 each line will be numbered
  	 numbersep=10pt,                                  % how far the line-numbers are from the code
  	 showspaces=false,
  	 showstringspaces=false,                         % underline spaces within strings
  	 breakautoindent=true,                        % sets if automatic breaks should only happen at whitespace
%       backgroundcolor=\color{white},          % choose the background color. You must add \usepackage{color}
%  	     showtabs=false,                                         % show tabs within strings adding particular underscores
%       frame=single,                                           % adds a frame around the code
%       captionpos=b,                                           % sets the caption-position to bottom
%        escapeinside={\%*}{*)                          % if you want to add a comment within your code
        breaklines=true}                                       % sets automatic line breaking

% Mathe-Pakete
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amsthm}		% Theorem-Umgebung, Beweise
\usepackage{amssymb}
\usepackage{cancel}
\usepackage{mathcomp}
\usepackage{nicefrac}

\usepackage{libertine}
\usepackage[libertine]{newtxmath}

%============================================================
% Titel, Autor, Datum
%============================================================
\title{Übung 5 \\Computational Physics III}
\author{Matthias Plock (552335) \and Paul Ledwon (561764)} %\\Otto Normalverbraucher (271828)}
\date{\today}

%============================================================
% Dokument
%============================================================
\begin{document}

% Titel erstellen
\maketitle
\tableofcontents

\pagenumbering{arabic}
\pagestyle{myheadings}                  % bzw. ist fancyhdr zu benutzten

\section{Spin-Modell}

\subsection{Über das Programm}

Der Programmcode liegt im Verzeichnis \texttt{src}, dort wurden zwei Dateien
erstellt. In der Datei \texttt{boltzmann.\{cu,h\}} sind die Programmfunktionen
implementiert, in der Datei \texttt{cases.\{cu,h\}} sind die
Testfälle/Aufgabenstellungen implementiert.

Das Programm wird mit Hilfe des Makefiles kompiliert und kann dann durch Aufruf
der Datei im Verzeichnis \texttt{bin} aufgerufen werden.
Die Aufgaben 1 bis 3 werden dann ausgeführt. Jedes Ergebnis wird durch ein
\texttt{assert()} getestet. Als Genauigkeitsgrenze wird konservativ
$N_{\text{Vol}}*\varepsilon$ gesetzt.

\subsection{Aufgabe 1}

Wir wählen als Dimension $N_{\text{Dim}} = 3$ und setzen für jede Dimension $5$
Gitterpunkte, erhalten also $N_{\text{Vol}} = 125$. Dies wird gemacht um die
Routinen zügig zu prüfen.

In einer Schleife über fünf Elemente setzen wir jeweils $z$, $h$, $\lambda$ und
$\kappa$ auf zufällige Werte. Anschließend wird die Wirkung $S\left[ \phi, h
\right]$ berechnet und mit dem analytischen Wert $S_{\text{Analytisch}}$
verglichen.




\section{Markov-Kette}

\subsection{Wahrscheinlichkeitsverteilung}
Jede Konfiguration der Markov-Kette $\Phi^{(1)}\to \Phi^{(2)}\to\dots\to \Phi^{(N)}$
folgt der angestrebten Wahrscheinlichkeitsverteilung, unter der Vorraussetzung,
dass $P[\Phi^{(1)}]$ der Wahrscheinlichkeitsverteilung folgt, denn \\

 \begin{align*}
	\int \prod_{k\neq n} D\Phi^{(k)} {\cal P}[\Phi^{(1)},...,\Phi^{(N)}] = \int \prod_{k\neq n} D\Phi^{(k)}P[\Phi^{(1)}] W[\Phi^{(1)}\to \Phi^{(2)}]...W[\Phi^{(N-1)}\to \Phi^{(N)}]= \\
	=\int \prod_{k <  n} D\Phi^{(k)}P[\Phi^{(1)}] W[\Phi^{(1)}\to \Phi^{(2)}]...W[\Phi^{(n-1)}\to \Phi^{(n)}] \int \prod_{k > n} D\Phi^{(k)} W[\Phi^{(n)}\to \Phi^{(n+1)}]...W[\Phi^{(N-1)}\to \Phi^{(N)}].
 \end{align*}

Wegen der Normierung gilt

 \begin{align*}
	\int \prod_{k > n} D\Phi^{(k)} W[\Phi^{(n)}\to \Phi^{(n+1)}]...W[\Phi^{(N-1)}\to \Phi^{(N)}]=1.
 \end{align*}

Zusammen mit dem Gleichgewicht $\int D\Phi P[\Phi] W[\Phi\to \Phi'] = P[\Phi']$ gilt dann
 \begin{align*}
      \int \prod_{k\neq n} D\Phi^{(k)} {\cal P}[\Phi^{(1)},...,\Phi^{(N)}] &= \int \prod_{k <  n} D\Phi^{(k)}P[\Phi^{(1)}] W[\Phi^{(1)}\to \Phi^{(2)}]...W[\Phi^{(n-1)}\to \Phi^{(n)}] \\
&=\int \prod_{1 < k <  n} D\Phi^{(k)}P[\Phi^{(2)}] W[\Phi^{(2)}\to \Phi^{(3)}]...W[\Phi^{(n-1)}\to \Phi^{(n)}]\\
&= ...\\
&=\int \prod_{n-2 < k <  n} D\Phi^{(k)}P[\Phi^{(n-1)}] W[\Phi^{(n-1)}\to \Phi^{(n)}] \\
&=\int  D\Phi^{(n-1)}P[\Phi^{(n-1)}] W[\Phi^{(n-1)}\to \Phi^{(n)}] = P[\Phi^{(n)}]
 \end{align*}

\subsection{Detailliertes Gleichgewicht der Metropolis-Übergangswahrscheinlichkeit}
Die Metropolis-Übergangswahrscheinlichkeit ist definiert als

\begin{align*}
	w_m(\Phi\to\Phi') = w_v(\Phi\to\Phi') \min \left(1,\frac{P[\Phi']}{P[\Phi]}\right) + [1-A(\Phi)]\delta(\Phi,\Phi')
\end{align*}

Die Vorschlagswahrscheinlichkeit soll symmetrisch sein, daher $w_v(\Phi\to\Phi')=w_v(\Phi'\to\Phi)$.

Damit das detaillierte Gleichgewicht erfüllt ist, muss gelten

\begin{align}\label{eq:gg}
P[\Phi] w_m(\Phi\to\Phi')= P[\Phi']w_m(\Phi'\to\Phi).
\end{align}

Für den Fall $\Phi = \Phi'$ wird Gleichung \ref{eq:gg} zu

\begin{align*}
	P[\Phi] w_v(\Phi\to\Phi) + [1-A(\Phi)] = P[\Phi] w_v(\Phi\to\Phi) + [1-A(\Phi)]
\end{align*}

und das detaillierte Gleichgewicht ist erfüllt.

Für den Fall $\Phi \neq \Phi'$ und ohne Beschränkung der Allgemeinheit $P[\Phi']>P[\Phi]$ wird Gleichung \ref{eq:gg} zu

\begin{align*}
		P[\Phi] w_v(\Phi\to\Phi') \frac{P[\Phi']}{P[\Phi]} = P[\Phi'] w_v(\Phi'\to\Phi)
		\Leftrightarrow w_v(\Phi\to\Phi')=w_v(\Phi'\to\Phi)
\end{align*}

Auch in diesem Fall ist wegen der Symmetrie der Vorschlagswahrscheinlichkeit das detaillierte Gleichgewicht erfüllt.




\end{document}
