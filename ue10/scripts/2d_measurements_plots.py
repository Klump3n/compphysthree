#!/usr/bin/env python3

import matplotlib.pyplot as plt
import numpy as np


def computeR(MagL,MagLErr, Mag2L,Mag2LErr):
    R = Mag2L/MagL#np.divide(Mag2L,MagL)
    tmp1 = np.square(Mag2LErr/MagL)#np.square(np.divide(Mag2LErr,MagL))
    tmp2 = np.square(MagLErr*Mag2L/np.square(MagL))#np.square(np.divide(np.multiply(MagLErr,Mag2L),np.square(Mag2L)))
    RErr = np.sqrt(tmp1+tmp2)
    return R, RErr

kappa = np.array([0.00, 0.025, 0.05, 0.075, 0.1, 0.125, 0.15, 0.175, 0.2,
                    0.225, 0.25, 0.275, 0.3, 0.325, 0.35, 0.375, 0.4, 0.425,
                    0.45, 0.475, 0.5, 0.525, 0.55, 0.575, 0.6])
#L=16, 2L=32, 2dim

MagL1 = np.array([0.003144,
                 0.003516,
                 0.003668,
                 0.004060,
                 0.004383,
                 0.004879,
                 0.005816,
                 0.005945,
                 0.007138,
                 0.009037,
                 0.009480,
                 0.010962,
                 0.015466,
                 0.016907,
                 0.024179,
                 0.042316,
                 0.082757,
                 0.165302,
                 0.370327,
                 0.556845,
                 0.647280,
                 0.806143,
                 0.905410,
                 0.964396,
                 1.066301,
                ])

Mag2L1 = np.array([
                0.000751,
                0.000815,
                0.000925,
                0.001020,
                0.001100,
                0.001189,
                0.001350,
                0.001647,
                0.001747,
                0.002152,
                0.002468,
                0.002941,
                0.004016,
                0.005461,
                0.006703,
                0.010891,
                0.019775,
                0.030020,
                0.147336,
                0.367047,
                0.579182,
                0.731827,
                0.776679,
                0.884943,
                0.990881,
                ])

MagL1Err = np.array([
                     0.000143,
                     0.000160,
                     0.000174,
                     0.000175,
                     0.000230,
                     0.000212,
                     0.000262,
                     0.000325,
                     0.000410,
                     0.000476,
                     0.000642,
                     0.000875,
                     0.001104,
                     0.001626,
                     0.002307,
                     0.005691,
                     0.015431,
                     0.020693,
                     0.017512,
                     0.015840,
                     0.020617,
                     0.016828,
                     0.010023,
                     0.015032,
                     0.010629,
                     ])


Mag2L1Err = np.array([
                      0.000034 ,
                      0.000038,
                      0.000044,
                      0.000047,
                      0.000054,
                      0.000056,
                      0.000064,
                      0.000087,
                      0.000116,
                      0.000116,
                      0.000138,
                      0.000223,
                      0.000296,
                      0.000495,
                      0.000571,
                      0.001269,
                      0.003358,
                      0.005482,
                      0.018130,
                      0.062126,
                      0.034678,
                      0.009921,
                      0.021918,
                      0.017887,
                      0.013574
                      ])

R1,R1Err = computeR(MagL1,MagL1Err,Mag2L1,Mag2L1Err)



#L=12, 2L=24, 2dim
MagL2 = np.array([
                 0.005587,
                 0.006114,
                 0.006297,
                 0.006502,
                 0.007808,
                 0.008787,
                 0.009084,
                 0.009835,
                 0.012731,
                 0.015250,
                 0.016825,
                 0.021671,
                 0.026238,
                 0.035073,
                 0.049768,
                 0.070105,
                 0.127972,
                 0.250626,
                 0.314586,
                 0.564339,
                 0.682738,
                 0.822456,
                 0.914499,
                 1.006668,
                 1.109278,
                  ])
Mag2L2 = np.array([
                   0.001295,
                   0.001502,
                   0.001619,
                   0.001830,
                   0.002074,
                   0.002065,
                   0.002482,
                   0.002770,
                   0.003235,
                   0.003682,
                   0.004451,
                   0.004861,
                   0.006047,
                   0.007956,
                   0.009797,
                   0.018907,
                   0.041796,
                   0.061882,
                   0.230662,
                   0.471387,
                   0.616238,
                   0.709229,
                   0.841275,
                   0.940967,
                   0.990300
                  ])
MagL2Err = np.array([
                    0.000245 ,
                    0.000256,
                    0.000293,
                    0.000284,
                    0.000369,
                    0.000452,
                    0.000441,
                    0.000470,
                    0.000720,
                    0.000824,
                    0.000906,
                    0.001602,
                    0.002799,
                    0.003998,
                    0.005281,
                    0.008306,
                    0.018202,
                    0.027346,
                    0.046306,
                    0.020634,
                    0.024532,
                    0.009912,
                    0.012165,
                    0.013031,
                    0.010269
                    ])


Mag2L2Err = np.array([
                     0.000058 ,
                     0.000071 ,
                     0.000071,
                     0.000076,
                     0.000096,
                     0.000117,
                     0.000114,
                     0.000144,
                     0.000203,
                     0.000204,
                     0.000308,
                     0.000324,
                     0.000422,
                     0.000654,
                     0.000956,
                     0.002656,
                     0.004965,
                     0.015746,
                     0.048075,
                     0.016519,
                     0.013142,
                     0.010398,
                     0.013059,
                     0.006958,
                     0.027683
                      ])


R2,R2Err = computeR(MagL2,MagL2Err,Mag2L2,Mag2L2Err)
plt.figure()
plt.errorbar(kappa,R1,R1Err,marker='o',label='L=16')
plt.errorbar(kappa, R2, R2Err,marker='x',label='L=12')
plt.title('R im 2D-System')
plt.xlabel('$\kappa$')
plt.ylabel('R')
plt.legend(loc='best')
plt.tight_layout()
plt.grid(1)
plt.savefig('../figures/2dR.pdf')
